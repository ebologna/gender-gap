ubicaciones.bases.dbf=list(
"individualprimer trimestre 2004 a 2015\\Ind_t104.dbf","individualprimer trimestre 2004 a 2015\\Ind_t105.dbf",
"individualprimer trimestre 2004 a 2015\\Ind_t106.dbf", "individualprimer trimestre 2004 a 2015\\Ind_t107.dbf",
"individualprimer trimestre 2004 a 2015\\Ind_t108.dbf", "individualprimer trimestre 2004 a 2015\\Ind_t109.dbf",
"individualprimer trimestre 2004 a 2015\\Ind_t110.dbf", "individualprimer trimestre 2004 a 2015\\Ind_t111.dbf",
"individualprimer trimestre 2004 a 2015\\Ind_t112.dbf", "individualprimer trimestre 2004 a 2015\\Ind_t113.dbf",
"individualprimer trimestre 2004 a 2015\\Ind_t114.dbf", "individualprimer trimestre 2004 a 2015\\Ind_t115.dbf")
ubicaciones.bases.txt=list(
"individualprimer trimestre 2004 a 2015\\usu_individual_t316.txt",
"individualprimer trimestre 2004 a 2015\\usu_individual_t117.txt",
"individualprimer trimestre 2004 a 2015\\usu_individual_t118.txt")
eph.dbf=vector("list",12)
for(i  in 1:12) eph.dbf[[i]]=read.dbf(ubicaciones.bases.dbf[[i]])
library(foreign)
for(i  in 1:12) eph.dbf[[i]]=read.dbf(ubicaciones.bases.dbf[[i]])
prop.activos=vector("list",15)
for (i in 1:15) {
prop.activos[[i]]=as.data.frame(ftable(prop.table(
table(eph[[i]]$condact, eph[[i]]$educacion, eph[[i]]$sexo),
c(3,2))))
names(prop.activos[[i]])=c("condicion", "educacion","sexo", "proporcion")
}
prop.activos[[15]]
library(foreign)
library(ggplot2)
library(ggthemes)
library(doBy)
library(scales)
##condicion de actividad por educacion y sexo
ubicaciones.bases.dbf=list(
"archivosINDEC\\Ind_t104.dbf","archivosINDEC\\Ind_t105.dbf",
"archivosINDEC\\Ind_t106.dbf", "archivosINDEC\\Ind_t107.dbf",
"archivosINDEC\\Ind_t108.dbf", "archivosINDEC\\Ind_t109.dbf",
"archivosINDEC\\Ind_t110.dbf", "archivosINDEC\\Ind_t111.dbf",
"archivosINDEC\\Ind_t112.dbf", "archivosINDEC\\Ind_t113.dbf",
"archivosINDEC\\Ind_t114.dbf", "archivosINDEC\\Ind_t115.dbf")
ubicaciones.bases.txt=list(
"archivosINDEC\\usu_individual_t316.txt",
"archivosINDEC\\usu_individual_t117.txt",
"archivosINDEC\\usu_individual_t118.txt")
eph.dbf=vector("list",12)
for(i  in 1:12) eph.dbf[[i]]=read.dbf(ubicaciones.bases.dbf[[i]])
eph.txt=vector("list",3)
for(i  in 1:3) eph.txt[[i]]=read.csv(ubicaciones.bases.txt[[i]], sep = ";")
for(i  in 1:3) eph.txt[[i]]$PP08D1[is.na(eph.txt[[i]]$PP08D1)]=0
eph=vector("list",15)
eph=c(eph.dbf,eph.txt)
##ordena niveles, rotula, elimina 0 y 4 de estado, edad>14
for (i in 1:15) {
eph[[i]]$sexo=as.factor(eph[[i]]$CH04)
levels(eph[[i]]$sexo)=c("varones", "mujeres")
eph[[i]]=subset(eph[[i]], eph[[i]]$ESTADO!=0 & eph[[i]]$ESTADO!=4 &
eph[[i]]$CH06>14)
eph[[i]]$actividad=as.factor(eph[[i]]$ESTADO)
levels(eph[[i]]$actividad)=c("ocupado", "desocupado", "inactivo")
eph[[i]]$educacion=factor(eph[[i]]$NIVEL_ED,
levels(factor(eph[[i]]$NIVEL_ED))[c(7,1:6)])
levels(eph[[i]]$educacion)=c("Sin instrucción",
"Primaria Incompleta",
"Primaria Completa","Secundaria Incompleta", "Secundaria Completa",
"Universitaria Incompleta","Universitaria Completa")
}
##se definen los activos
for (i in 1:15) {
eph[[i]]$condact=ifelse(eph[[i]]$ESTADO==3, 0, 1)
}
eph[[15]]$condact=factor(eph[[15]]$condact)
levels(eph[[15]]$condact)
for (i in 1:15) {
eph[[i]]$condact=factor(eph[[i]]$condact)
levels(eph[[i]]$condact)=c("inactivos", "activos")
}
levels(eph[[15]]$condact)
prop.activos=vector("list",15)
for (i in 1:15) {
prop.activos[[i]]=as.data.frame(ftable(prop.table(
table(eph[[i]]$condact, eph[[i]]$educacion, eph[[i]]$sexo),
c(3,2))))
names(prop.activos[[i]])=c("condicion", "educacion","sexo", "proporcion")
}
prop.activos[[15]]
graficos.condact=vector("list",15)
for (i in 1:15) {
graficos.condact[[i]]=ggplot(eph[[i]])+
geom_bar(aes(x=educacion, fill=factor(condact,
levels=c("activos","inactivos"))), position = "fill")+
scale_fill_brewer(type = "div", palette = "Set2", direction = 1,
aesthetics = "fill")+
guides(fill=guide_legend(title=NULL))+
geom_text(data=prop.activos[[i]],position=position_stack(vjust=.5),
size=3, aes(x= educacion,
y=proporcion,label =paste(100*round(proporcion,3),"%")))+
labs(
title="Condición de actividad según nivel de educación y sexo",
subtitle = paste("Argentina. Aglomerados Urbanos primer trimestre",eph[[i]]$ANO4),
caption="Fuente: Encuesta Permanente de Hogares, INDEC www.indec.gob.ar",
x="Máximo nivel de educación alcanzado"
)+theme_economist(base_family = "serif", base_size = 9)+
theme(axis.line=element_blank(),axis.text.y=element_blank(),
axis.title.y=element_blank(),
axis.ticks=element_blank(),legend.title=element_blank(),
plot.title = element_text(hjust = 0.5))+
facet_grid(sexo~.)
}
graficos.condact[[15]]
graficos.condact[[10]]
graficos.condact[[1]]
for(i in 1:15){
ggsave(filename = paste("condiciondeactividad", eph[[i]]$ANO4,
".png"),
path = "graficos\\condicion_actividad",
plot = graficos.condact[[i]], device = "png",
scale = 1.7)
}
#################
###desocupacion
solo.activos=vector("list", 15)
for (i in 1:15) {
solo.activos[[i]]=subset(eph[[i]],
eph[[i]]$ESTADO==1 | eph[[i]]$ESTADO==2)
solo.activos[[i]]$actividad=factor(solo.activos[[i]]$actividad)
# para descartar el nivel no usado
}
props.d=vector("list",15)
for (i in 1:15) {
props.d[[i]]=as.data.frame(ftable(prop.table(
table(solo.activos[[i]]$actividad, solo.activos[[i]]$educacion,
solo.activos[[i]]$sexo),
c(3,2))))
names(props.d[[i]])=
c("ocupacion", "educacion","sexo", "proporcion")
}
graficos.desocupacion=vector("list", 15)
for (i in 1:15) {
graficos.desocupacion[[i]]=ggplot(solo.activos[[i]])+
geom_bar(aes(x=educacion, fill=factor(actividad,
levels=c("desocupado",
"ocupado"))),
position = "fill")+
scale_fill_brewer(type = "div", palette = "Set2", direction = 1,
aesthetics = "fill")+
guides(fill=guide_legend(title=NULL))+
geom_text(data=props.d[[i]],
position=position_stack(vjust=0.5), size=3,
aes(x= educacion,y=proporcion,
label =paste(100*round(proporcion,3),"%")))+
labs(
title="Condición de ocupación de la población económicamente activa
según nivel de educación y sexo",
subtitle = paste("Argentina. Aglomerados Urbanos primer trimestre",eph[[i]]$ANO4),
caption="Fuente: Encuesta Permanente de Hogares, INDEC www.indec.gob.ar",
x="Máximo nivel de educación alcanzado"
)+theme_economist(base_family = "serif", base_size = 9)+
theme(axis.line=element_blank(),axis.text.y=element_blank(),
axis.title.y=element_blank(),
axis.ticks=element_blank(),legend.title=element_blank(),
plot.title = element_text(hjust = 0.5))+
facet_grid(sexo~.)
}
graficos.desocupacion[[15]]
graficos.desocupacion[[1]]
knitr::opts_chunk$set(echo = TRUE)
solo.activos.3.cats=vector("list", 15)
for (i in 1:15) {
solo.activos.3.cats[[i]]=subset(solo.activos[[i]], solo.activos[[i]]$CAT_OCUP==1 |
solo.activos[[i]]$CAT_OCUP==2|
solo.activos[[i]]$CAT_OCUP==3)
solo.activos.3.cats[[i]]$categoria=
as.factor(as.character(solo.activos.3.cats[[i]]$CAT_OCUP))
levels(solo.activos.3.cats[[i]]$categoria)=c("Patrón", "Cuenta propia","Obrero o empleado")
}
precariedad.sexo.educacion=vector("list",15)
for (i in 1:15) {
precariedad.sexo.educacion[[i]]=
summaryBy(PP07G_59 ~ sexo+educacion , data = solo.activos[[i]],
FUN = function(x) { c(m = mean(x, na.rm = TRUE)/5) })
}
for (i in 1:15) {
precariedad.graficos[[i]] =ggplot(precariedad.sexo.educacion[[i]])+
geom_point(aes(
educacion, sexo, size=100*PP07G_59.m), show.legend = FALSE)+
geom_text(aes(educacion, sexo,
label=paste(
round(100*PP07G_59.m,0),"%")), vjust=-3.7)+
scale_size_continuous(
range = c(3, 27))+xlab("Máximo nivel de educación")+
ylab("Sexo")+
labs(
title="Proporción de asalariados precarios según sexo y nivel de educación",
subtitle = paste("Argentina. Aglomerados Urbanos primer trimestre",eph[[i]]$ANO4),
caption="Fuente: Encuesta Permanente de Hogares, INDEC www.indec.gob.ar")+
theme_economist(base_family = "serif", base_size = 9)
}
precariedad.sexo.educacion=vector("list",15)
for (i in 1:15) {
precariedad.sexo.educacion[[i]]=
summaryBy(PP07G_59 ~ sexo+educacion , data = solo.activos[[i]],
FUN = function(x) { c(m = mean(x, na.rm = TRUE)/5) })
}
precariedad.graficos=vector("list", 15)
for (i in 1:15) {
precariedad.graficos[[i]] =ggplot(precariedad.sexo.educacion[[i]])+
geom_point(aes(
educacion, sexo, size=100*PP07G_59.m), show.legend = FALSE)+
geom_text(aes(educacion, sexo,
label=paste(
round(100*PP07G_59.m,0),"%")), vjust=-3.7)+
scale_size_continuous(
range = c(3, 27))+xlab("Máximo nivel de educación")+
ylab("Sexo")+
labs(
title="Proporción de asalariados precarios según sexo y nivel de educación",
subtitle = paste("Argentina. Aglomerados Urbanos primer trimestre",eph[[i]]$ANO4),
caption="Fuente: Encuesta Permanente de Hogares, INDEC www.indec.gob.ar")+
theme_economist(base_family = "serif", base_size = 9)
}
for(i in 1:15){
ggsave(filename = paste("precariedad", eph[[i]]$ANO4,
".png"),
plot = precariedad.graficos[[i]], device = "png",
scale = 1.7)
}
precariedad.graficos[[15]]
ggsave(filename = "precariedad2018.png",
plot = graf.precariedad.2018, device = "png",
path = "graficos\\precariedad",
scale = 1.7)
precariedad.sexo.educacion=vector("list",15)
for (i in 1:15) {
precariedad.sexo.educacion[[i]]=
summaryBy(PP07G_59 ~ sexo+educacion , data = solo.activos[[i]],
FUN = function(x) { c(m = mean(x, na.rm = TRUE)/5) })
}
precariedad.graficos=vector("list", 15)
for (i in 1:15) {
precariedad.graficos[[i]] =ggplot(precariedad.sexo.educacion[[i]])+
geom_point(aes(
educacion, sexo, size=100*PP07G_59.m), show.legend = FALSE)+
geom_text(aes(educacion, sexo,
label=paste(
round(100*PP07G_59.m,0),"%")), vjust=-3.7)+
scale_size_continuous(
range = c(3, 27))+xlab("Máximo nivel de educación")+
ylab("Sexo")+
labs(
title="Proporción de asalariados precarios según sexo y nivel de educación",
subtitle = paste("Argentina. Aglomerados Urbanos primer trimestre",eph[[i]]$ANO4),
caption="Fuente: Encuesta Permanente de Hogares, INDEC www.indec.gob.ar")+
theme_economist(base_family = "serif", base_size = 9)
}
for(i in 1:15){
ggsave(filename = paste("precariedad", eph[[i]]$ANO4,
".png"),
plot = precariedad.graficos[[i]], device = "png",
path = "graficos\\precariedad",
scale = 1.7)
}
